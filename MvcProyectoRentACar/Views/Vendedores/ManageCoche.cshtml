@model List<Reserva>
@{
	Coche coche = ViewData["coche"] as Coche;
	List<EstadoReserva> estadoReserva = ViewData["estado"] as List<EstadoReserva>;
	int contador = 1;
}

<div class="container-fluid py-5">
	<div class="container pt-5 pb-3">
		<h1 class="display-4 text-uppercase text-center mb-5">Reservas del @coche.Marca @coche.Modelo</h1>
		@if(Model.Count() == 0){
			<h3 class="text-uppercase text-center">No existen reservas</h3>
		}else{
			<div class="table-responsive">
				<table class="table  table-hover table-bordered">
					<thead>
						<tr>
							<th>Coche</th>
							<th>Estado</th>
							<th>Fecha inicio</th>
							<th>Fecha fin</th>
							<th>Cambiar Estado</th>
						</tr>
					</thead>
					<tbody>
						@foreach (Reserva reserva in Model)
						{
							<tr>
								<td>@coche.Marca</td>
								@foreach (EstadoReserva estado in estadoReserva)
								{
									if (reserva.IdEstadoReserva == estado.IdEstadoReserva)
									{
										if (estado.EstadoDescripcion == "Activo")
										{
											<td> <span class="badge badge-success"> @estado.EstadoDescripcion</span></td>
										}
										else if (estado.EstadoDescripcion == "Espera")
										{
											<td> <span class="badge badge-warning"> @estado.EstadoDescripcion</span></td>
										}
										else
										{
											<td> <span class="badge badge-danger"> @estado.EstadoDescripcion</span></td>
										}

										break;
									}
								}
								<td>@reserva.FechaInicio.ToString("dd/MM/yyyy")</td>
								<td>@reserva.FechaFin.ToString("dd/MM/yyyy")</td>
								@if (contador == 1 && reserva.IdEstadoReserva != 1)
								{
									<form method="post">
									<td>
										<input value="@coche.IdCoche" hidden />
										<button class="btn btn-primary" name="setactive" value="@reserva.IdReserva">Establecer Activo</button>
									</td>
									</form>
								}
								@{
									contador++;
								}
								
								@* @if (reserva.IdEstadoReserva == 1)
								{
									<form method="post">
									<td>
										<input value="@coche.IdCoche" hidden />
										<button class="btn btn-primary" name="setactive" value="@reserva.IdReserva">Establecer Activo</button>
										<button class="btn btn-danger" name="finalizado" value="@reserva.IdReserva">Finalizar Alquiler</button>
									</td>
									</form>

								}
								else
								{
									<form method="post">
									<td>
										<input value="@coche.IdCoche" hidden />
										<button class="btn btn-primary" name="setactive" value="@reserva.IdReserva">Establecer Activo</button>
									</td>
									</form>
								} *@

							</tr>
						}
					</tbody>
				</table>
			</div>
		}
		
	</div>
</div>
